"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[741],{5242:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var o=n(4848),t=n(8453);const s={sidebar_position:4},r="Admin",c={id:"api/admin",title:"Admin",description:"Introduzione",source:"@site/pages/api/admin.md",sourceDirName:"api",slug:"/api/admin",permalink:"/docs/pages/api/admin",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/pages/api/admin.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"apiSidebar",previous:{title:"Fleet Management",permalink:"/docs/pages/api/fleet"},next:{title:"CONNECTIVITY_API",permalink:"/docs/pages/api/connectivity"}},l={},a=[{value:"Introduzione",id:"introduzione",level:2},{value:"Importazioni Principali",id:"importazioni-principali",level:2},{value:"Endpoints Principali",id:"endpoints-principali",level:2},{value:"<code>/orgs</code> - Ottenere le organizzazioni",id:"orgs---ottenere-le-organizzazioni",level:3},{value:"<code>/fleets</code> - Ottenere le flotte",id:"fleets---ottenere-le-flotte",level:3},{value:"<code>/vehicles/{protocol}/operations</code> - Ottenere operazioni per un protocollo di veicolo",id:"vehiclesprotocoloperations---ottenere-operazioni-per-un-protocollo-di-veicolo",level:3},{value:"<code>/vehicles</code> - Lista dei veicoli",id:"vehicles---lista-dei-veicoli",level:3},{value:"<code>/vehicles.geojson</code> - Veicoli in formato GeoJSON",id:"vehiclesgeojson---veicoli-in-formato-geojson",level:3},{value:"<code>/vehicles/{id}/command/start</code> e <code>/vehicles/{id}/command/unlock</code> - Comandi di controllo sui veicoli",id:"vehiclesidcommandstart-e-vehiclesidcommandunlock---comandi-di-controllo-sui-veicoli",level:3},{value:"<code>/vehicles/{id}/rentals</code> - Ottenere noleggi di un veicolo",id:"vehiclesidrentals---ottenere-noleggi-di-un-veicolo",level:3},{value:"<code>/payments</code> - Pagamenti",id:"payments---pagamenti",level:3},{value:"<code>/reimburse</code> - Rimborso",id:"reimburse---rimborso",level:3},{value:"<code>/settings</code> - Ottenere impostazioni",id:"settings---ottenere-impostazioni",level:3},{value:"<code>/docs</code> - Ottenere documenti dell&#39;utente",id:"docs---ottenere-documenti-dellutente",level:3},{value:"Utilizzo di Redis per il caching",id:"utilizzo-di-redis-per-il-caching",level:2},{value:"Autenticazione",id:"autenticazione",level:2},{value:"Gestione dei Permessi",id:"gestione-dei-permessi",level:2},{value:"Considerazioni Finali",id:"considerazioni-finali",level:2}];function d(e){const i={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"admin",children:"Admin"})}),"\n",(0,o.jsx)(i.h2,{id:"introduzione",children:"Introduzione"}),"\n",(0,o.jsxs)(i.p,{children:["Questo codice fornisce un'implementazione di un router ",(0,o.jsx)(i.code,{children:"FastAPI"})," per un sistema amministrativo legato alla gestione di veicoli, flotte, utenti, pagamenti e statistiche. Si interfaccia con diverse API esterne per ottenere informazioni sui veicoli, eseguire comandi sui veicoli e gestire utenti e pagamenti. Il codice fa largo uso di richieste HTTP verso API esterne, gestendo token di autenticazione e utilizzando ",(0,o.jsx)(i.strong,{children:"Redis"})," per il caching."]}),"\n",(0,o.jsx)(i.h2,{id:"importazioni-principali",children:"Importazioni Principali"}),"\n",(0,o.jsx)(i.p,{children:"Le librerie importate includono:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.code,{children:"FastAPI"}),": framework per costruire API web in Python."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.code,{children:"Pydantic"}),": per la gestione dei modelli di dati e la validazione."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.code,{children:"requests"}),": per eseguire richieste HTTP verso API esterne."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.code,{children:"redis"}),": per connettersi a Redis, un database NoSQL in-memory usato per caching."]}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"endpoints-principali",children:"Endpoints Principali"}),"\n",(0,o.jsxs)(i.h3,{id:"orgs---ottenere-le-organizzazioni",children:[(0,o.jsx)(i.code,{children:"/orgs"})," - Ottenere le organizzazioni"]}),"\n",(0,o.jsxs)(i.p,{children:["Effettua una richiesta GET per ottenere una lista di organizzazioni associate a un utente. L'endpoint accetta un'intestazione di autorizzazione e una serie di parametri opzionali come ",(0,o.jsx)(i.code,{children:"client_id"}),", ",(0,o.jsx)(i.code,{children:"user_lat"}),", ",(0,o.jsx)(i.code,{children:"user_lon"}),"."]}),"\n",(0,o.jsxs)(i.h3,{id:"fleets---ottenere-le-flotte",children:[(0,o.jsx)(i.code,{children:"/fleets"})," - Ottenere le flotte"]}),"\n",(0,o.jsxs)(i.p,{children:["Questo endpoint permette di elencare le flotte di veicoli associate a un cliente o a un utente. Effettua una richiesta GET verso un'API esterna e accetta parametri come ",(0,o.jsx)(i.code,{children:"vehicle"}),", ",(0,o.jsx)(i.code,{children:"client_id"}),", ",(0,o.jsx)(i.code,{children:"user_lat"}),", ",(0,o.jsx)(i.code,{children:"user_lon"}),"."]}),"\n",(0,o.jsxs)(i.h3,{id:"vehiclesprotocoloperations---ottenere-operazioni-per-un-protocollo-di-veicolo",children:[(0,o.jsx)(i.code,{children:"/vehicles/{protocol}/operations"})," - Ottenere operazioni per un protocollo di veicolo"]}),"\n",(0,o.jsx)(i.p,{children:"Recupera operazioni associate a un protocollo di veicolo specifico. Viene passato un protocollo come parametro nell'URL."}),"\n",(0,o.jsxs)(i.h3,{id:"vehicles---lista-dei-veicoli",children:[(0,o.jsx)(i.code,{children:"/vehicles"})," - Lista dei veicoli"]}),"\n",(0,o.jsxs)(i.p,{children:["Fornisce una lista di veicoli con opzioni di filtro come ",(0,o.jsx)(i.code,{children:"ipp"}),", ",(0,o.jsx)(i.code,{children:"page"}),", ",(0,o.jsx)(i.code,{children:"sort"}),", e ",(0,o.jsx)(i.code,{children:"filter"}),". Fa una richiesta GET a un'API esterna per ottenere una lista di veicoli."]}),"\n",(0,o.jsxs)(i.h3,{id:"vehiclesgeojson---veicoli-in-formato-geojson",children:[(0,o.jsx)(i.code,{children:"/vehicles.geojson"})," - Veicoli in formato GeoJSON"]}),"\n",(0,o.jsx)(i.p,{children:"Restituisce una lista di veicoli in formato GeoJSON, con possibilit\xe0 di filtrare i risultati in base al livello di zoom."}),"\n",(0,o.jsxs)(i.h3,{id:"vehiclesidcommandstart-e-vehiclesidcommandunlock---comandi-di-controllo-sui-veicoli",children:[(0,o.jsx)(i.code,{children:"/vehicles/{id}/command/start"})," e ",(0,o.jsx)(i.code,{children:"/vehicles/{id}/command/unlock"})," - Comandi di controllo sui veicoli"]}),"\n",(0,o.jsxs)(i.p,{children:["Questi endpoint sono usati per inviare comandi di avvio e sblocco ai veicoli tramite l'API dei veicoli. Accettano vari parametri opzionali tramite header, tra cui ",(0,o.jsx)(i.code,{children:"authorization"}),", ",(0,o.jsx)(i.code,{children:"client_id"}),", ",(0,o.jsx)(i.code,{children:"user_lat"})," e ",(0,o.jsx)(i.code,{children:"user_lon"}),"."]}),"\n",(0,o.jsxs)(i.h3,{id:"vehiclesidrentals---ottenere-noleggi-di-un-veicolo",children:[(0,o.jsx)(i.code,{children:"/vehicles/{id}/rentals"})," - Ottenere noleggi di un veicolo"]}),"\n",(0,o.jsxs)(i.p,{children:["Fornisce un elenco di noleggi associati a un determinato veicolo. \xc8 possibile specificare il numero di elementi per pagina tramite il parametro ",(0,o.jsx)(i.code,{children:"ipp"})," e il numero di pagina con ",(0,o.jsx)(i.code,{children:"page"}),"."]}),"\n",(0,o.jsxs)(i.h3,{id:"payments---pagamenti",children:[(0,o.jsx)(i.code,{children:"/payments"})," - Pagamenti"]}),"\n",(0,o.jsxs)(i.p,{children:["Questo endpoint \xe8 utilizzato per ottenere i dettagli sui pagamenti. Accetta vari parametri opzionali come ",(0,o.jsx)(i.code,{children:"user"}),", ",(0,o.jsx)(i.code,{children:"vehicle"}),", ",(0,o.jsx)(i.code,{children:"fleet"}),", ",(0,o.jsx)(i.code,{children:"trip"}),", ",(0,o.jsx)(i.code,{children:"ipp"}),", ",(0,o.jsx)(i.code,{children:"page"}),", ",(0,o.jsx)(i.code,{children:"sort"})," e ",(0,o.jsx)(i.code,{children:"filter"})," per fornire un elenco filtrato di pagamenti."]}),"\n",(0,o.jsxs)(i.h3,{id:"reimburse---rimborso",children:[(0,o.jsx)(i.code,{children:"/reimburse"})," - Rimborso"]}),"\n",(0,o.jsx)(i.p,{children:"Endpoint per eseguire il rimborso di un pagamento. Accetta un payload JSON e lo invia all'API dei veicoli."}),"\n",(0,o.jsxs)(i.h3,{id:"settings---ottenere-impostazioni",children:[(0,o.jsx)(i.code,{children:"/settings"})," - Ottenere impostazioni"]}),"\n",(0,o.jsx)(i.p,{children:"Questo endpoint consente di ottenere le impostazioni di un client specifico, utilizzando un'API esterna per recuperare le informazioni."}),"\n",(0,o.jsxs)(i.h3,{id:"docs---ottenere-documenti-dellutente",children:[(0,o.jsx)(i.code,{children:"/docs"})," - Ottenere documenti dell'utente"]}),"\n",(0,o.jsx)(i.p,{children:"Questo endpoint effettua una richiesta GET all'API per ottenere i documenti associati a un cliente, con possibilit\xe0 di filtrare i risultati per stato, pagina, e numero di elementi per pagina."}),"\n",(0,o.jsx)(i.h2,{id:"utilizzo-di-redis-per-il-caching",children:"Utilizzo di Redis per il caching"}),"\n",(0,o.jsx)(i.p,{children:"Due istanze di Redis sono configurate:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"CACHE"}),": utilizzato per gestire il caching di messaggi ed eventi."]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"GEOCACHE"}),": utilizzato per la gestione di dati geospaziali relativi ai veicoli."]}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"autenticazione",children:"Autenticazione"}),"\n",(0,o.jsxs)(i.p,{children:["L'autenticazione si basa sull'intestazione ",(0,o.jsx)(i.code,{children:"Authorization"})," fornita in ciascuna richiesta. Il metodo ",(0,o.jsx)(i.code,{children:"get_user(authorization)"})," viene chiamato per recuperare l'utente associato al token di autorizzazione."]}),"\n",(0,o.jsx)(i.h2,{id:"gestione-dei-permessi",children:"Gestione dei Permessi"}),"\n",(0,o.jsxs)(i.p,{children:["Viene utilizzata una funzione ",(0,o.jsx)(i.code,{children:"get_permissions(user)"})," per verificare se un utente ha i permessi per accedere o eseguire determinate operazioni, come elencare le flotte o inviare comandi ai veicoli."]}),"\n",(0,o.jsx)(i.h2,{id:"considerazioni-finali",children:"Considerazioni Finali"}),"\n",(0,o.jsx)(i.p,{children:"Questo codice rappresenta un'architettura di API complessa che sfrutta il routing di FastAPI, interagisce con pi\xf9 API esterne e utilizza Redis per caching e gestione dei dati in tempo reale. La struttura e l'uso dei comandi suggeriscono che l'applicazione gestisce una piattaforma di gestione della flotta di veicoli con funzionalit\xe0 avanzate di amministrazione."})]})}function u(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>r,x:()=>c});var o=n(6540);const t={},s=o.createContext(t);function r(e){const i=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(s.Provider,{value:i},e.children)}}}]);